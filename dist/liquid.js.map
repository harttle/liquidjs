{"version":3,"file":"liquid.js","sources":["../node_modules/regenerator-runtime/runtime.js","../src/util/underscore.js","../src/lexical.js","../src/util/error.js","../src/util/assert.js","../src/scope.js","../src/template-browser.js","../src/whitespace-ctrl.js","../src/tokenizer.js","../src/operators.js","../src/syntax.js","../src/render.js","../src/tag.js","../src/filter.js","../src/parser.js","../src/util/promise.js","../src/tags/for.js","../src/tags/assign.js","../src/tags/capture.js","../src/tags/case.js","../src/tags/comment.js","../src/tags/include.js","../src/tags/decrement.js","../src/tags/cycle.js","../src/tags/if.js","../src/tags/increment.js","../src/tags/layout.js","../src/tags/raw.js","../src/tags/tablerow.js","../src/tags/unless.js","../src/tags/index.js","../src/util/strftime.js","../src/filters.js","../src/index.js"],"sourcesContent":["/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  runtime.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  runtime.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        if (delegate.iterator.return) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // In sloppy mode, unbound `this` refers to the global object, fallback to\n  // Function constructor if we're in global strict mode. That is sadly a form\n  // of indirect eval which violates Content Security Policy.\n  (function() {\n    return this || (typeof self === \"object\" && self);\n  })() || Function(\"return this\")()\n);\n","const toStr = Object.prototype.toString\r\n\r\n/*\r\n * Checks if value is classified as a String primitive or object.\r\n * @param {any} value The value to check.\r\n * @return {Boolean} Returns true if value is a string, else false.\r\n */\r\nexport function isString (value) {\r\n  return toStr.call(value) === '[object String]'\r\n}\r\n\r\nexport function promisify (fn) {\r\n  return function () {\r\n    return new Promise((resolve, reject) => {\r\n      fn(...arguments, (err, result) => {\r\n        err ? reject(err) : resolve(result)\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\nexport function stringify (value) {\r\n  if (isNil(value)) {\r\n    return String(value)\r\n  }\r\n  if (typeof value.to_liquid === 'function') {\r\n    return stringify(value.to_liquid())\r\n  }\r\n  if (typeof value.toLiquid === 'function') {\r\n    return stringify(value.toLiquid())\r\n  }\r\n  if (isString(value) || value instanceof RegExp || value instanceof Date) {\r\n    return value.toString()\r\n  }\r\n\r\n  const cache = []\r\n  return JSON.stringify(value, (key, value) => {\r\n    if (isObject(value)) {\r\n      if (cache.indexOf(value) !== -1) {\r\n        return\r\n      }\r\n      cache.push(value)\r\n    }\r\n    return value\r\n  })\r\n}\r\n\r\nexport function create (proto) {\r\n  return Object.create(proto)\r\n}\r\n\r\nexport function isNil (value) {\r\n  return value === null || value === undefined\r\n}\r\n\r\nexport function isArray (value) {\r\n  // be compatible with IE 8\r\n  return toStr.call(value) === '[object Array]'\r\n}\r\n\r\nexport function isError (value) {\r\n  const signature = toStr.call(value)\r\n  // [object XXXError]\r\n  return signature.substr(-6, 5) === 'Error' ||\r\n        (typeof value.message === 'string' && typeof value.name === 'string')\r\n}\r\n\r\n/*\r\n * Iterates over own enumerable string keyed properties of an object and invokes iteratee for each property.\r\n * The iteratee is invoked with three arguments: (value, key, object).\r\n * Iteratee functions may exit iteration early by explicitly returning false.\r\n * @param {Object} object The object to iterate over.\r\n * @param {Function} iteratee The function invoked per iteration.\r\n * @return {Object} Returns object.\r\n */\r\nexport function forOwn (object, iteratee) {\r\n  object = object || {}\r\n  for (const k in object) {\r\n    if (object.hasOwnProperty(k)) {\r\n      if (iteratee(object[k], k, object) === false) break\r\n    }\r\n  }\r\n  return object\r\n}\r\n\r\n/*\r\n * Assigns own enumerable string keyed properties of source objects to the destination object.\r\n * Source objects are applied from left to right.\r\n * Subsequent sources overwrite property assignments of previous sources.\r\n *\r\n * Note: This method mutates object and is loosely based on Object.assign.\r\n *\r\n * @param {Object} object The destination object.\r\n * @param {...Object} sources The source objects.\r\n * @return {Object} Returns object.\r\n */\r\nexport function assign (object) {\r\n  object = isObject(object) ? object : {}\r\n  const srcs = Array.prototype.slice.call(arguments, 1)\r\n  srcs.forEach((src) => Object.assign(object, src))\r\n  return object\r\n}\r\n\r\nexport function last (arr) {\r\n  return arr[arr.length - 1]\r\n}\r\n\r\nexport function uniq (arr) {\r\n  const u = {}\r\n  const a = []\r\n  for (let i = 0, l = arr.length; i < l; ++i) {\r\n    if (u.hasOwnProperty(arr[i])) {\r\n      continue\r\n    }\r\n    a.push(arr[i])\r\n    u[arr[i]] = 1\r\n  }\r\n  return a\r\n}\r\n\r\n/*\r\n * Checks if value is the language type of Object.\r\n * (e.g. arrays, functions, objects, regexes, new Number(0), and new String(''))\r\n * @param {any} value The value to check.\r\n * @return {Boolean} Returns true if value is an object, else false.\r\n */\r\nexport function isObject (value) {\r\n  const type = typeof value\r\n  return value !== null && (type === 'object' || type === 'function')\r\n}\r\n\r\n/*\r\n * A function to create flexibly-numbered lists of integers,\r\n * handy for each and map loops. start, if omitted, defaults to 0; step defaults to 1.\r\n * Returns a list of integers from start (inclusive) to stop (exclusive),\r\n * incremented (or decremented) by step, exclusive.\r\n * Note that ranges that stop before they start are considered to be zero-length instead of\r\n * negative â€” if you'd like a negative range, use a negative step.\r\n */\r\nexport function range (start, stop, step) {\r\n  if (arguments.length === 1) {\r\n    stop = start\r\n    start = 0\r\n  }\r\n  step = step || 1\r\n\r\n  const arr = []\r\n  for (let i = start; i < stop; i += step) {\r\n    arr.push(i)\r\n  }\r\n  return arr\r\n}\r\n","// quote related\r\nconst singleQuoted = /'[^']*'/\r\nconst doubleQuoted = /\"[^\"]*\"/\r\nexport const quoted = new RegExp(`${singleQuoted.source}|${doubleQuoted.source}`)\r\nexport const quoteBalanced = new RegExp(`(?:${quoted.source}|[^'\"])*`)\r\n\r\n// basic types\r\nexport const integer = /-?\\d+/\r\nexport const number = /-?\\d+\\.?\\d*|\\.?\\d+/\r\nexport const bool = /true|false/\r\n\r\n// property access\r\nexport const identifier = /[\\w-]+[?]?/\r\nexport const subscript = new RegExp(`\\\\[(?:${quoted.source}|[\\\\w-\\\\.]+)\\\\]`)\r\nexport const literal = new RegExp(`(?:${quoted.source}|${bool.source}|${number.source})`)\r\nexport const variable = new RegExp(`${identifier.source}(?:\\\\.${identifier.source}|${subscript.source})*`)\r\n\r\n// range related\r\nexport const rangeLimit = new RegExp(`(?:${variable.source}|${number.source})`)\r\nexport const range = new RegExp(`\\\\(${rangeLimit.source}\\\\.\\\\.${rangeLimit.source}\\\\)`)\r\nexport const rangeCapture = new RegExp(`\\\\((${rangeLimit.source})\\\\.\\\\.(${rangeLimit.source})\\\\)`)\r\n\r\nexport const value = new RegExp(`(?:${variable.source}|${literal.source}|${range.source})`)\r\n\r\n// hash related\r\nexport const hash = new RegExp(`(?:${identifier.source})\\\\s*:\\\\s*(?:${value.source})`)\r\nexport const hashCapture = new RegExp(`(${identifier.source})\\\\s*:\\\\s*(${value.source})`, 'g')\r\n\r\n// full match\r\nexport const tagLine = new RegExp(`^\\\\s*(${identifier.source})\\\\s*([\\\\s\\\\S]*)\\\\s*$`)\r\nexport const literalLine = new RegExp(`^${literal.source}$`, 'i')\r\nexport const variableLine = new RegExp(`^${variable.source}$`)\r\nexport const numberLine = new RegExp(`^${number.source}$`)\r\nexport const boolLine = new RegExp(`^${bool.source}$`, 'i')\r\nexport const quotedLine = new RegExp(`^${quoted.source}$`)\r\nexport const rangeLine = new RegExp(`^${rangeCapture.source}$`)\r\nexport const integerLine = new RegExp(`^${integer.source}$`)\r\n\r\n// filter related\r\nexport const valueDeclaration = new RegExp(`(?:${identifier.source}\\\\s*:\\\\s*)?${value.source}`)\r\nexport const valueList = new RegExp(`${valueDeclaration.source}(\\\\s*,\\\\s*${valueDeclaration.source})*`)\r\nexport const filter = new RegExp(`${identifier.source}(?:\\\\s*:\\\\s*${valueList.source})?`, 'g')\r\nexport const filterCapture = new RegExp(`(${identifier.source})(?:\\\\s*:\\\\s*(${valueList.source}))?`)\r\nexport const filterLine = new RegExp(`^${filterCapture.source}$`)\r\n\r\nexport const operators = [\r\n  /\\s+or\\s+/,\r\n  /\\s+and\\s+/,\r\n  /==|!=|<=|>=|<|>|\\s+contains\\s+/\r\n]\r\n\r\nexport function isInteger (str) {\r\n  return integerLine.test(str)\r\n}\r\n\r\nexport function isLiteral (str) {\r\n  return literalLine.test(str)\r\n}\r\n\r\nexport function isRange (str) {\r\n  return rangeLine.test(str)\r\n}\r\n\r\nexport function isVariable (str) {\r\n  return variableLine.test(str)\r\n}\r\n\r\nexport function matchValue (str) {\r\n  return value.exec(str)\r\n}\r\n\r\nexport function parseLiteral (str) {\r\n  let res = str.match(numberLine)\r\n  if (res) {\r\n    return Number(str)\r\n  }\r\n  res = str.match(boolLine)\r\n  if (res) {\r\n    return str.toLowerCase() === 'true'\r\n  }\r\n  res = str.match(quotedLine)\r\n  if (res) {\r\n    return str.slice(1, -1)\r\n  }\r\n  throw new TypeError(`cannot parse '${str}' as literal`)\r\n}\r\n","import * as _ from './underscore.js'\r\n\r\nfunction initError () {\r\n  this.name = this.constructor.name\r\n  if (Error.captureStackTrace) {\r\n    Error.captureStackTrace(this, this.constructor)\r\n  }\r\n}\r\n\r\nfunction initLiquidError (err, token) {\r\n  initError.call(this)\r\n\r\n  this.input = token.input\r\n  this.line = token.line\r\n  this.file = token.file\r\n\r\n  const context = mkContext(token.input, token.line)\r\n  this.message = mkMessage(err.message, token)\r\n  this.stack = context +\r\n    '\\n' + (this.stack || this.message) +\r\n      (err.stack ? '\\nFrom ' + err.stack : '')\r\n}\r\n\r\nexport function TokenizationError (message, token) {\r\n  initLiquidError.call(this, {message: message}, token)\r\n}\r\nTokenizationError.prototype = _.create(Error.prototype)\r\nTokenizationError.prototype.constructor = TokenizationError\r\n\r\nexport function ParseError (e, token) {\r\n  _.assign(this, e)\r\n  this.originalError = e\r\n\r\n  initLiquidError.call(this, e, token)\r\n}\r\nParseError.prototype = _.create(Error.prototype)\r\nParseError.prototype.constructor = ParseError\r\n\r\nexport function RenderError (e, tpl) {\r\n  // return the original render error\r\n  if (e instanceof RenderError) {\r\n    return e\r\n  }\r\n  _.assign(this, e)\r\n  this.originalError = e\r\n\r\n  initLiquidError.call(this, e, tpl.token)\r\n}\r\nRenderError.prototype = _.create(Error.prototype)\r\nRenderError.prototype.constructor = RenderError\r\n\r\nexport function RenderBreakError (message) {\r\n  initError.call(this)\r\n  this.message = message + ''\r\n}\r\nRenderBreakError.prototype = _.create(Error.prototype)\r\nRenderBreakError.prototype.constructor = RenderBreakError\r\n\r\nexport function AssertionError (message) {\r\n  initError.call(this)\r\n  this.message = message + ''\r\n}\r\nAssertionError.prototype = _.create(Error.prototype)\r\nAssertionError.prototype.constructor = AssertionError\r\n\r\nfunction mkContext (input, line) {\r\n  const lines = input.split('\\n')\r\n  const begin = Math.max(line - 2, 1)\r\n  const end = Math.min(line + 3, lines.length)\r\n\r\n  const context = _\r\n    .range(begin, end + 1)\r\n    .map(l => [\r\n      (l === line) ? '>> ' : '   ',\r\n      align(l, end),\r\n      '| ',\r\n      lines[l - 1]\r\n    ].join(''))\r\n    .join('\\n')\r\n\r\n  return context\r\n}\r\n\r\nfunction align (n, max) {\r\n  const length = (max + '').length\r\n  const str = n + ''\r\n  const blank = Array(length - str.length).join(' ')\r\n  return blank + str\r\n}\r\n\r\nfunction mkMessage (msg, token) {\r\n  msg = msg || ''\r\n  if (token.file) {\r\n    msg += ', file:' + token.file\r\n  }\r\n  if (token.line) {\r\n    msg += ', line:' + token.line\r\n  }\r\n  return msg\r\n}\r\n","import {AssertionError} from './error.js'\r\n\r\nexport default function (predicate, message) {\r\n  if (!predicate) {\r\n    message = message || `expect ${predicate} to be true`\r\n    throw new AssertionError(message)\r\n  }\r\n}\r\n","import * as _ from './util/underscore.js'\r\nimport * as lexical from './lexical.js'\r\nimport assert from './util/assert.js'\r\n\r\nconst Scope = {\r\n  getAll: function () {\r\n    return this.contexts.reduce((ctx, val) => _.assign(ctx, val), _.create(null))\r\n  },\r\n  get: function (path) {\r\n    const paths = this.propertyAccessSeq(path)\r\n    const scope = this.findContextFor(paths[0]) || _.last(this.contexts)\r\n    return paths.reduce((value, key) => this.readProperty(value, key), scope)\r\n  },\r\n  set: function (path, v) {\r\n    const paths = this.propertyAccessSeq(path)\r\n    let scope = this.findContextFor(paths[0]) || _.last(this.contexts)\r\n    paths.some((key, i) => {\r\n      if (!_.isObject(scope)) {\r\n        return true\r\n      }\r\n      if (i === paths.length - 1) {\r\n        scope[key] = v\r\n        return true\r\n      }\r\n      if (undefined === scope[key]) {\r\n        scope[key] = {}\r\n      }\r\n      scope = scope[key]\r\n    })\r\n  },\r\n  unshift: function (ctx) {\r\n    return this.contexts.unshift(ctx)\r\n  },\r\n  push: function (ctx) {\r\n    return this.contexts.push(ctx)\r\n  },\r\n  pop: function (ctx) {\r\n    if (!arguments.length) {\r\n      return this.contexts.pop()\r\n    }\r\n    const i = this.contexts.findIndex(scope => scope === ctx)\r\n    if (i === -1) {\r\n      throw new TypeError('scope not found, cannot pop')\r\n    }\r\n    return this.contexts.splice(i, 1)[0]\r\n  },\r\n  findContextFor: function (key, filter) {\r\n    filter = filter || (() => true)\r\n    for (let i = this.contexts.length - 1; i >= 0; i--) {\r\n      const candidate = this.contexts[i]\r\n      if (!filter(candidate)) continue\r\n      if (key in candidate) {\r\n        return candidate\r\n      }\r\n    }\r\n    return null\r\n  },\r\n  readProperty: function (obj, key) {\r\n    let val\r\n    if (_.isNil(obj)) {\r\n      val = undefined\r\n    } else {\r\n      if (typeof obj.to_liquid === 'function') {\r\n        obj = obj.to_liquid()\r\n      } else if (typeof obj.toLiquid === 'function') {\r\n        obj = obj.toLiquid()\r\n      }\r\n\r\n      if (key === 'size' && (_.isArray(obj) || _.isString(obj))) {\r\n        val = obj.length\r\n      } else {\r\n        val = obj[key]\r\n      }\r\n    }\r\n    if (_.isNil(val) && this.opts.strict_variables) {\r\n      throw new TypeError(`undefined variable: ${key}`)\r\n    }\r\n    return val\r\n  },\r\n\r\n  /*\r\n   * Parse property access sequence from access string\r\n   * @example\r\n   * accessSeq(\"foo.bar\")            // ['foo', 'bar']\r\n   * accessSeq(\"foo['bar']\")      // ['foo', 'bar']\r\n   * accessSeq(\"foo['b]r']\")      // ['foo', 'b]r']\r\n   * accessSeq(\"foo[bar.coo]\")    // ['foo', 'bar'], for bar.coo == 'bar'\r\n   */\r\n  propertyAccessSeq: function (str) {\r\n    str = String(str)\r\n    const seq = []\r\n    let name = ''\r\n    let j\r\n    let i = 0\r\n    while (i < str.length) {\r\n      switch (str[i]) {\r\n        case '[':\r\n          push()\r\n\r\n          const delemiter = str[i + 1]\r\n          if (/['\"]/.test(delemiter)) { // foo[\"bar\"]\r\n            j = str.indexOf(delemiter, i + 2)\r\n            assert(j !== -1, `unbalanced ${delemiter}: ${str}`)\r\n            name = str.slice(i + 2, j)\r\n            push()\r\n            i = j + 2\r\n          } else { // foo[bar.coo]\r\n            j = matchRightBracket(str, i + 1)\r\n            assert(j !== -1, `unbalanced []: ${str}`)\r\n            name = str.slice(i + 1, j)\r\n            if (!lexical.isInteger(name)) { // foo[bar] vs. foo[1]\r\n              name = String(this.get(name))\r\n            }\r\n            push()\r\n            i = j + 1\r\n          }\r\n          break\r\n        case '.':// foo.bar, foo[0].bar\r\n          push()\r\n          i++\r\n          break\r\n        default:// foo.bar\r\n          name += str[i]\r\n          i++\r\n      }\r\n    }\r\n    push()\r\n\r\n    if (!seq.length) {\r\n      throw new TypeError(`invalid path:\"${str}\"`)\r\n    }\r\n    return seq\r\n\r\n    function push () {\r\n      if (name.length) seq.push(name)\r\n      name = ''\r\n    }\r\n  }\r\n}\r\n\r\nfunction matchRightBracket (str, begin) {\r\n  let stack = 1 // count of '[' - count of ']'\r\n  for (let i = begin; i < str.length; i++) {\r\n    if (str[i] === '[') {\r\n      stack++\r\n    }\r\n    if (str[i] === ']') {\r\n      stack--\r\n      if (stack === 0) {\r\n        return i\r\n      }\r\n    }\r\n  }\r\n  return -1\r\n}\r\n\r\nexport function factory (ctx, opts) {\r\n  const defaultOptions = {\r\n    dynamicPartials: true,\r\n    strict_variables: false,\r\n    strict_filters: false,\r\n    blocks: {},\r\n    root: []\r\n  }\r\n  const scope = _.create(Scope)\r\n  scope.opts = _.assign(defaultOptions, opts)\r\n  scope.contexts = [ctx || {}]\r\n  return scope\r\n}\r\n","import {last, isArray} from './util/underscore'\r\n\r\nfunction domResolve (root, path) {\r\n  const base = document.createElement('base')\r\n  base.href = root\r\n\r\n  const head = document.getElementsByTagName('head')[0]\r\n  head.insertBefore(base, head.firstChild)\r\n\r\n  const a = document.createElement('a')\r\n  a.href = path\r\n  const resolved = a.href\r\n  head.removeChild(base)\r\n\r\n  return resolved\r\n}\r\n\r\nexport function resolve (filepath, root, options) {\r\n  root = root || options.root\r\n  if (isArray(root)) {\r\n    root = root[0]\r\n  }\r\n  if (root.length && last(root) !== '/') {\r\n    root += '/'\r\n  }\r\n  const url = domResolve(root, filepath)\r\n  return url.replace(/^(\\w+:\\/\\/[^/]+)(\\/[^?]+)/, (str, origin, path) => {\r\n    const last = path.split('/').pop()\r\n    if (/\\.\\w+$/.test(last)) {\r\n      return str\r\n    }\r\n    return origin + path + options.extname\r\n  })\r\n}\r\n\r\nexport async function read (url) {\r\n  return new Promise((resolve, reject) => {\r\n    const xhr = new XMLHttpRequest()\r\n    xhr.onload = () => {\r\n      if (xhr.status >= 200 && xhr.status < 300) {\r\n        resolve(xhr.responseText)\r\n      } else {\r\n        reject(new Error(xhr.statusText))\r\n      }\r\n    }\r\n    xhr.onerror = () => {\r\n      reject(new Error('An error occurred whilst receiving the response.'))\r\n    }\r\n    xhr.open('GET', url)\r\n    xhr.send()\r\n  })\r\n}\r\n","import {assign} from './util/underscore.js'\r\n\r\nexport default function whiteSpaceCtrl (tokens, options) {\r\n  options = assign({ greedy: true }, options)\r\n  let inRaw = false\r\n\r\n  tokens.forEach((token, i) => {\r\n    if (shouldTrimLeft(token, inRaw, options)) {\r\n      trimLeft(tokens[i - 1], options.greedy)\r\n    }\r\n\r\n    if (token.type === 'tag' && token.name === 'raw') inRaw = true\r\n    if (token.type === 'tag' && token.name === 'endraw') inRaw = false\r\n\r\n    if (shouldTrimRight(token, inRaw, options)) {\r\n      trimRight(tokens[i + 1], options.greedy)\r\n    }\r\n  })\r\n}\r\n\r\nfunction shouldTrimLeft (token, inRaw, options) {\r\n  if (inRaw) return false\r\n  if (token.type === 'tag') return token.trim_left || options.trim_tag_left\r\n  if (token.type === 'value') return token.trim_left || options.trim_value_left\r\n}\r\n\r\nfunction shouldTrimRight (token, inRaw, options) {\r\n  if (inRaw) return false\r\n  if (token.type === 'tag') return token.trim_right || options.trim_tag_right\r\n  if (token.type === 'value') return token.trim_right || options.trim_value_right\r\n}\r\n\r\nfunction trimLeft (token, greedy) {\r\n  if (!token || token.type !== 'html') return\r\n\r\n  const rLeft = greedy ? /\\s+$/g : /[\\t\\r ]*$/g\r\n  token.value = token.value.replace(rLeft, '')\r\n}\r\n\r\nfunction trimRight (token, greedy) {\r\n  if (!token || token.type !== 'html') return\r\n\r\n  const rRight = greedy ? /^\\s+/g : /^[\\t\\r ]*\\n?/g\r\n  token.value = token.value.replace(rRight, '')\r\n}\r\n","import * as lexical from './lexical.js'\r\nimport {TokenizationError} from './util/error.js'\r\nimport * as _ from './util/underscore.js'\r\nimport assert from './util/assert.js'\r\nimport whiteSpaceCtrl from './whitespace-ctrl.js'\r\n\r\nexport {default as whiteSpaceCtrl} from './whitespace-ctrl.js'\r\n\r\nexport function parse (input, file, options) {\r\n  assert(_.isString(input), 'illegal input')\r\n\r\n  const rLiquid = /({%-?([\\s\\S]*?)-?%})|({{-?([\\s\\S]*?)-?}})/g\r\n  let currIndent = 0\r\n  const lineNumber = LineNumber(input)\r\n  let lastMatchEnd = 0\r\n  const tokens = []\r\n\r\n  for (let match; (match = rLiquid.exec(input)); lastMatchEnd = rLiquid.lastIndex) {\r\n    if (match.index > lastMatchEnd) {\r\n      tokens.push(parseHTMLToken(lastMatchEnd, match.index))\r\n    }\r\n    tokens.push(match[1]\r\n      ? parseTagToken(match[1], match[2].trim(), match.index)\r\n      : parseValueToken(match[3], match[4].trim(), match.index))\r\n  }\r\n  if (input.length > lastMatchEnd) {\r\n    tokens.push(parseHTMLToken(lastMatchEnd, input.length))\r\n  }\r\n  whiteSpaceCtrl(tokens, options)\r\n  return tokens\r\n\r\n  function parseTagToken (raw, value, pos) {\r\n    const match = value.match(lexical.tagLine)\r\n    const token = {\r\n      type: 'tag',\r\n      indent: currIndent,\r\n      line: lineNumber.get(pos),\r\n      trim_left: raw.slice(0, 3) === '{%-',\r\n      trim_right: raw.slice(-3) === '-%}',\r\n      raw,\r\n      value,\r\n      input,\r\n      file\r\n    }\r\n    if (!match) {\r\n      throw new TokenizationError(`illegal tag syntax`, token)\r\n    }\r\n    token.name = match[1]\r\n    token.args = match[2]\r\n    return token\r\n  }\r\n\r\n  function parseValueToken (raw, value, pos) {\r\n    return {\r\n      type: 'value',\r\n      line: lineNumber.get(pos),\r\n      trim_left: raw.slice(0, 3) === '{{-',\r\n      trim_right: raw.slice(-3) === '-}}',\r\n      raw,\r\n      value,\r\n      input,\r\n      file\r\n    }\r\n  }\r\n\r\n  function parseHTMLToken (begin, end) {\r\n    const htmlFragment = input.slice(begin, end)\r\n    currIndent = _.last((htmlFragment).split('\\n')).length\r\n\r\n    return {\r\n      type: 'html',\r\n      raw: htmlFragment,\r\n      value: htmlFragment\r\n    }\r\n  }\r\n}\r\n\r\nfunction LineNumber (html) {\r\n  let parsedLinesCount = 0\r\n  let lastMatchBegin = -1\r\n\r\n  return {\r\n    get: function (pos) {\r\n      const lines = html.slice(lastMatchBegin + 1, pos).split('\\n')\r\n      parsedLinesCount += lines.length - 1\r\n      lastMatchBegin = pos\r\n      return parsedLinesCount + 1\r\n    }\r\n  }\r\n}\r\n","export default function (isTruthy) {\r\n  return {\r\n    '==': (l, r) => l === r,\r\n    '!=': (l, r) => l !== r,\r\n    '>': (l, r) => l !== null && r !== null && l > r,\r\n    '<': (l, r) => l !== null && r !== null && l < r,\r\n    '>=': (l, r) => l !== null && r !== null && l >= r,\r\n    '<=': (l, r) => l !== null && r !== null && l <= r,\r\n    'contains': (l, r) => {\r\n      if (!l) return false\r\n      if (typeof l.indexOf !== 'function') return false\r\n      return l.indexOf(r) > -1\r\n    },\r\n    'and': (l, r) => isTruthy(l) && isTruthy(r),\r\n    'or': (l, r) => isTruthy(l) || isTruthy(r)\r\n  }\r\n}\r\n","import Operators from './operators.js'\r\nimport * as lexical from './lexical.js'\r\nimport assert from './util/assert.js'\r\n\r\nconst operators = Operators(isTruthy)\r\n\r\nexport function evalExp (exp, scope) {\r\n  assert(scope, 'unable to evalExp: scope undefined')\r\n  const operatorREs = lexical.operators\r\n  let match\r\n  for (let i = 0; i < operatorREs.length; i++) {\r\n    const operatorRE = operatorREs[i]\r\n    const expRE = new RegExp(`^(${lexical.quoteBalanced.source})(${operatorRE.source})(${lexical.quoteBalanced.source})$`)\r\n    if ((match = exp.match(expRE))) {\r\n      const l = evalExp(match[1], scope)\r\n      const op = operators[match[2].trim()]\r\n      const r = evalExp(match[3], scope)\r\n      return op(l, r)\r\n    }\r\n  }\r\n\r\n  if ((match = exp.match(lexical.rangeLine))) {\r\n    const low = evalValue(match[1], scope)\r\n    const high = evalValue(match[2], scope)\r\n    const range = []\r\n    for (let j = low; j <= high; j++) {\r\n      range.push(j)\r\n    }\r\n    return range\r\n  }\r\n\r\n  return evalValue(exp, scope)\r\n}\r\n\r\nexport function evalValue (str, scope) {\r\n  str = str && str.trim()\r\n  if (!str) return undefined\r\n\r\n  if (lexical.isLiteral(str)) {\r\n    return lexical.parseLiteral(str)\r\n  }\r\n  if (lexical.isVariable(str)) {\r\n    return scope.get(str)\r\n  }\r\n  throw new TypeError(`cannot eval '${str}' as value`)\r\n}\r\n\r\nexport function isTruthy (val) {\r\n  return !isFalsy(val)\r\n}\r\n\r\nexport function isFalsy (val) {\r\n  return val === false || undefined === val || val === null\r\n}\r\n","import {evalExp} from './syntax.js'\r\nimport {RenderBreakError, RenderError} from './util/error.js'\r\nimport {stringify, create} from './util/underscore.js'\r\nimport assert from './util/assert.js'\r\n\r\nconst render = {\r\n  renderTemplates: async function (templates, scope) {\r\n    assert(scope, 'unable to evalTemplates: scope undefined')\r\n\r\n    let html = ''\r\n    for (const tpl of templates) {\r\n      try {\r\n        html += await renderTemplate.call(this, tpl)\r\n      } catch (e) {\r\n        if (e instanceof RenderBreakError) {\r\n          e.resolvedHTML = html\r\n          throw e\r\n        }\r\n        throw new RenderError(e, tpl)\r\n      }\r\n    }\r\n    return html\r\n\r\n    async function renderTemplate (template) {\r\n      if (template.type === 'tag') {\r\n        const partial = await this.renderTag(template, scope)\r\n        return partial === undefined ? '' : partial\r\n      }\r\n      if (template.type === 'value') {\r\n        return this.renderValue(template, scope)\r\n      }\r\n      return template.value\r\n    }\r\n  },\r\n\r\n  renderTag: async function (template, scope) {\r\n    if (template.name === 'continue') {\r\n      throw new RenderBreakError('continue')\r\n    }\r\n    if (template.name === 'break') {\r\n      throw new RenderBreakError('break')\r\n    }\r\n    return template.render(scope)\r\n  },\r\n\r\n  renderValue: async function (template, scope) {\r\n    const partial = this.evalValue(template, scope)\r\n    return partial === undefined ? '' : stringify(partial)\r\n  },\r\n\r\n  evalValue: function (template, scope) {\r\n    assert(scope, 'unable to evalValue: scope undefined')\r\n    return template.filters.reduce(\r\n      (prev, filter) => filter.render(prev, scope),\r\n      evalExp(template.initial, scope))\r\n  }\r\n}\r\n\r\nexport default function () {\r\n  const instance = create(render)\r\n  return instance\r\n}\r\n","import {hashCapture} from './lexical.js'\r\nimport {create} from './util/underscore.js'\r\nimport {evalValue} from './syntax.js'\r\nimport assert from './util/assert.js'\r\n\r\nfunction hash (markup, scope) {\r\n  const obj = {}\r\n  let match\r\n  hashCapture.lastIndex = 0\r\n  while ((match = hashCapture.exec(markup))) {\r\n    const k = match[1]\r\n    const v = match[2]\r\n    obj[k] = evalValue(v, scope)\r\n  }\r\n  return obj\r\n}\r\n\r\nexport default function () {\r\n  let tagImpls = {}\r\n\r\n  const _tagInstance = {\r\n    render: async function (scope) {\r\n      const obj = hash(this.token.args, scope)\r\n      const impl = this.tagImpl\r\n      if (typeof impl.render !== 'function') {\r\n        return ''\r\n      }\r\n      return impl.render(scope, obj)\r\n    },\r\n    parse: function (token, tokens) {\r\n      this.type = 'tag'\r\n      this.token = token\r\n      this.name = token.name\r\n\r\n      const tagImpl = tagImpls[this.name]\r\n      assert(tagImpl, `tag ${this.name} not found`)\r\n      this.tagImpl = create(tagImpl)\r\n      if (this.tagImpl.parse) {\r\n        this.tagImpl.parse(token, tokens)\r\n      }\r\n    }\r\n  }\r\n\r\n  function register (name, tag) {\r\n    tagImpls[name] = tag\r\n  }\r\n\r\n  function construct (token, tokens) {\r\n    const instance = create(_tagInstance)\r\n    instance.parse(token, tokens)\r\n    return instance\r\n  }\r\n\r\n  function clear () {\r\n    tagImpls = {}\r\n  }\r\n\r\n  return {\r\n    construct,\r\n    register,\r\n    clear\r\n  }\r\n}\r\n","import * as lexical from './lexical.js'\r\nimport {evalValue} from './syntax.js'\r\nimport assert from './util/assert.js'\r\nimport {assign, create} from './util/underscore.js'\r\n\r\nconst valueRE = new RegExp(`${lexical.value.source}`, 'g')\r\n\r\nexport default function (options) {\r\n  options = assign({}, options)\r\n  let filters = {}\r\n\r\n  const _filterInstance = {\r\n    render: function (output, scope) {\r\n      const args = this.args.map(arg => evalValue(arg, scope))\r\n      args.unshift(output)\r\n      return this.filter.apply(null, args)\r\n    },\r\n    parse: function (str) {\r\n      let match = lexical.filterLine.exec(str)\r\n      assert(match, 'illegal filter: ' + str)\r\n\r\n      const name = match[1]\r\n      const argList = match[2] || ''\r\n      const filter = filters[name]\r\n      if (typeof filter !== 'function') {\r\n        if (options.strict_filters) {\r\n          throw new TypeError(`undefined filter: ${name}`)\r\n        }\r\n        this.name = name\r\n        this.filter = x => x\r\n        this.args = []\r\n        return this\r\n      }\r\n\r\n      const args = []\r\n      while ((match = valueRE.exec(argList.trim()))) {\r\n        const v = match[0]\r\n        const re = new RegExp(`${v}\\\\s*:`, 'g')\r\n        const keyMatch = re.exec(match.input)\r\n        const currentMatchIsKey = keyMatch && keyMatch.index === match.index\r\n        currentMatchIsKey ? args.push(`'${v}'`) : args.push(v)\r\n      }\r\n\r\n      this.name = name\r\n      this.filter = filter\r\n      this.args = args\r\n\r\n      return this\r\n    }\r\n  }\r\n\r\n  function construct (str) {\r\n    const instance = create(_filterInstance)\r\n    return instance.parse(str)\r\n  }\r\n\r\n  function register (name, filter) {\r\n    filters[name] = filter\r\n  }\r\n\r\n  function clear () {\r\n    filters = {}\r\n  }\r\n\r\n  return {\r\n    construct, register, clear\r\n  }\r\n}\r\n","import * as lexical from './lexical.js'\r\nimport {create} from './util/underscore.js'\r\nimport {ParseError} from './util/error.js'\r\nimport assert from './util/assert.js'\r\n\r\nexport default function (Tag, Filter) {\r\n  const stream = {\r\n    init: function (tokens) {\r\n      this.tokens = tokens\r\n      this.handlers = {}\r\n      return this\r\n    },\r\n    on: function (name, cb) {\r\n      this.handlers[name] = cb\r\n      return this\r\n    },\r\n    trigger: function (event, arg) {\r\n      const h = this.handlers[event]\r\n      if (typeof h === 'function') {\r\n        h(arg)\r\n        return true\r\n      }\r\n    },\r\n    start: function () {\r\n      this.trigger('start')\r\n      let token\r\n      while (!this.stopRequested && (token = this.tokens.shift())) {\r\n        if (this.trigger('token', token)) continue\r\n        if (token.type === 'tag' &&\r\n            this.trigger(`tag:${token.name}`, token)) {\r\n          continue\r\n        }\r\n        const template = parseToken(token, this.tokens)\r\n        this.trigger('template', template)\r\n      }\r\n      if (!this.stopRequested) this.trigger('end')\r\n      return this\r\n    },\r\n    stop: function () {\r\n      this.stopRequested = true\r\n      return this\r\n    }\r\n  }\r\n\r\n  function parse (tokens) {\r\n    let token\r\n    const templates = []\r\n    while ((token = tokens.shift())) {\r\n      templates.push(parseToken(token, tokens))\r\n    }\r\n    return templates\r\n  }\r\n\r\n  function parseToken (token, tokens) {\r\n    try {\r\n      let tpl = null\r\n      if (token.type === 'tag') {\r\n        tpl = parseTag(token, tokens)\r\n      } else if (token.type === 'value') {\r\n        tpl = parseValue(token.value)\r\n      } else { // token.type === 'html'\r\n        tpl = token\r\n      }\r\n      tpl.token = token\r\n      return tpl\r\n    } catch (e) {\r\n      throw new ParseError(e, token)\r\n    }\r\n  }\r\n\r\n  function parseTag (token, tokens) {\r\n    if (token.name === 'continue' || token.name === 'break') return token\r\n    return Tag.construct(token, tokens)\r\n  }\r\n\r\n  function parseValue (str) {\r\n    let match = lexical.matchValue(str)\r\n    assert(match, `illegal value string: ${str}`)\r\n\r\n    const initial = match[0]\r\n    str = str.substr(match.index + match[0].length)\r\n\r\n    const filters = []\r\n    while ((match = lexical.filter.exec(str))) {\r\n      filters.push([match[0].trim()])\r\n    }\r\n\r\n    return {\r\n      type: 'value',\r\n      initial: initial,\r\n      filters: filters.map(str => Filter.construct(str))\r\n    }\r\n  }\r\n\r\n  function parseStream (tokens) {\r\n    const s = create(stream)\r\n    return s.init(tokens)\r\n  }\r\n\r\n  return {\r\n    parse,\r\n    parseTag,\r\n    parseStream,\r\n    parseValue\r\n  }\r\n}\r\n","/*\r\n * Call functions in serial until someone resolved.\r\n * @param {Array} iterable the array to iterate with.\r\n * @param {Array} iteratee returns a new promise.\r\n * The iteratee is invoked with three arguments: (value, index, iterable).\r\n */\r\nexport function anySeries (iterable, iteratee) {\r\n  let ret = Promise.reject(new Error('init'))\r\n  iterable.forEach(function (item, idx) {\r\n    ret = ret.catch(e => iteratee(item, idx, iterable))\r\n  })\r\n  return ret\r\n}\r\n\r\n/*\r\n * Call functions in serial until someone rejected.\r\n * @param {Array} iterable the array to iterate with.\r\n * @param {Array} iteratee returns a new promise.\r\n * The iteratee is invoked with three arguments: (value, index, iterable).\r\n */\r\nexport function mapSeries (iterable, iteratee) {\r\n  let ret = Promise.resolve('init')\r\n  const result = []\r\n  iterable.forEach(function (item, idx) {\r\n    ret = ret\r\n      .then(() => iteratee(item, idx, iterable))\r\n      .then(x => result.push(x))\r\n  })\r\n  return ret.then(() => result)\r\n}\r\n","import {mapSeries} from '../util/promise.js'\r\nimport {isString, isObject, isArray} from '../util/underscore.js'\r\nimport assert from '../util/assert.js'\r\nimport {identifier, value, hash} from '../lexical.js'\r\n\r\nexport default function (liquid, Liquid) {\r\n  const RenderBreakError = Liquid.Types.RenderBreakError\r\n  const re = new RegExp(`^(${identifier.source})\\\\s+in\\\\s+` +\r\n      `(${value.source})` +\r\n      `(?:\\\\s+${hash.source})*` +\r\n      `(?:\\\\s+(reversed))?` +\r\n      `(?:\\\\s+${hash.source})*$`)\r\n\r\n  liquid.registerTag('for', {parse, render})\r\n\r\n  function parse (tagToken, remainTokens) {\r\n    const match = re.exec(tagToken.args)\r\n    assert(match, `illegal tag: ${tagToken.raw}`)\r\n    this.variable = match[1]\r\n    this.collection = match[2]\r\n    this.reversed = !!match[3]\r\n\r\n    this.templates = []\r\n    this.elseTemplates = []\r\n\r\n    let p\r\n    const stream = liquid.parser.parseStream(remainTokens)\r\n      .on('start', () => (p = this.templates))\r\n      .on('tag:else', () => (p = this.elseTemplates))\r\n      .on('tag:endfor', () => stream.stop())\r\n      .on('template', tpl => p.push(tpl))\r\n      .on('end', () => {\r\n        throw new Error(`tag ${tagToken.raw} not closed`)\r\n      })\r\n\r\n    stream.start()\r\n  }\r\n  async function render (scope, hash) {\r\n    let collection = Liquid.evalExp(this.collection, scope)\r\n\r\n    if (!isArray(collection)) {\r\n      if (isString(collection) && collection.length > 0) {\r\n        collection = [collection]\r\n      } else if (isObject(collection)) {\r\n        collection = Object.keys(collection).map((key) => [key, collection[key]])\r\n      }\r\n    }\r\n    if (!isArray(collection) || !collection.length) {\r\n      return liquid.renderer.renderTemplates(this.elseTemplates, scope)\r\n    }\r\n\r\n    const offset = hash.offset || 0\r\n    const limit = (hash.limit === undefined) ? collection.length : hash.limit\r\n\r\n    collection = collection.slice(offset, offset + limit)\r\n    if (this.reversed) collection.reverse()\r\n\r\n    const contexts = collection.map((item, i) => {\r\n      const ctx = {}\r\n      ctx[this.variable] = item\r\n      ctx.forloop = {\r\n        first: i === 0,\r\n        index: i + 1,\r\n        index0: i,\r\n        last: i === collection.length - 1,\r\n        length: collection.length,\r\n        rindex: collection.length - i,\r\n        rindex0: collection.length - i - 1\r\n      }\r\n      return ctx\r\n    })\r\n\r\n    let html = ''\r\n    let finished = false\r\n    await mapSeries(contexts, async context => {\r\n      if (finished) return\r\n\r\n      scope.push(context)\r\n      try {\r\n        html += await liquid.renderer.renderTemplates(this.templates, scope)\r\n      } catch (e) {\r\n        if (e instanceof RenderBreakError) {\r\n          html += e.resolvedHTML\r\n          if (e.message === 'break') {\r\n            finished = true\r\n          }\r\n        } else throw e\r\n      }\r\n      scope.pop(context)\r\n    })\r\n    return html\r\n  }\r\n}\r\n","import assert from '../util/assert.js'\nimport {identifier} from '../lexical.js'\nimport {create} from '../util/underscore.js'\n\nexport default function (liquid, Liquid) {\n  const re = new RegExp(`(${identifier.source})\\\\s*=([^]*)`)\n  const {AssignScope} = Liquid.Types\n\n  liquid.registerTag('assign', {\n    parse: function (token) {\n      const match = token.args.match(re)\n      assert(match, `illegal token ${token.raw}`)\n      this.key = match[1]\n      this.value = match[2]\n    },\n    render: function (scope) {\n      const ctx = create(AssignScope)\n      ctx[this.key] = liquid.evalValue(this.value, scope)\n      scope.push(ctx)\n      return Promise.resolve('')\n    }\n  })\n}\n","import assert from '../util/assert.js'\r\nimport {create} from '../util/underscore.js'\r\nimport {identifier} from '../lexical.js'\r\n\r\nexport default function (liquid, Liquid) {\r\n  const re = new RegExp(`(${identifier.source})`)\r\n  const {CaptureScope} = Liquid.Types\r\n\r\n  liquid.registerTag('capture', {\r\n    parse: function (tagToken, remainTokens) {\r\n      const match = tagToken.args.match(re)\r\n      assert(match, `${tagToken.args} not valid identifier`)\r\n\r\n      this.variable = match[1]\r\n      this.templates = []\r\n\r\n      const stream = liquid.parser.parseStream(remainTokens)\r\n      stream.on('tag:endcapture', token => stream.stop())\r\n        .on('template', tpl => this.templates.push(tpl))\r\n        .on('end', x => {\r\n          throw new Error(`tag ${tagToken.raw} not closed`)\r\n        })\r\n      stream.start()\r\n    },\r\n    render: async function (scope, hash) {\r\n      const html = await liquid.renderer.renderTemplates(this.templates, scope)\r\n      const ctx = create(CaptureScope)\r\n      ctx[this.variable] = html\r\n      scope.push(ctx)\r\n    }\r\n  })\r\n}\r\n","export default function (liquid, Liquid) {\r\n  liquid.registerTag('case', {\r\n\r\n    parse: function (tagToken, remainTokens) {\r\n      this.cond = tagToken.args\r\n      this.cases = []\r\n      this.elseTemplates = []\r\n\r\n      let p = []\r\n      const stream = liquid.parser.parseStream(remainTokens)\r\n        .on('tag:when', token => {\r\n          this.cases.push({\r\n            val: token.args,\r\n            templates: p = []\r\n          })\r\n        })\r\n        .on('tag:else', () => (p = this.elseTemplates))\r\n        .on('tag:endcase', token => stream.stop())\r\n        .on('template', tpl => p.push(tpl))\r\n        .on('end', x => {\r\n          throw new Error(`tag ${tagToken.raw} not closed`)\r\n        })\r\n\r\n      stream.start()\r\n    },\r\n\r\n    render: function (scope, hash) {\r\n      for (let i = 0; i < this.cases.length; i++) {\r\n        const branch = this.cases[i]\r\n        const val = Liquid.evalExp(branch.val, scope)\r\n        const cond = Liquid.evalExp(this.cond, scope)\r\n        if (val === cond) {\r\n          return liquid.renderer.renderTemplates(branch.templates, scope)\r\n        }\r\n      }\r\n      return liquid.renderer.renderTemplates(this.elseTemplates, scope)\r\n    }\r\n  })\r\n}\r\n","export default function (liquid) {\r\n  liquid.registerTag('comment', {\r\n    parse: function (tagToken, remainTokens) {\r\n      const stream = liquid.parser.parseStream(remainTokens)\r\n      stream\r\n        .on('token', token => {\r\n          if (token.name === 'endcomment') stream.stop()\r\n        })\r\n        .on('end', x => {\r\n          throw new Error(`tag ${tagToken.raw} not closed`)\r\n        })\r\n      stream.start()\r\n    }\r\n  })\r\n}\r\n","import assert from '../util/assert.js'\r\nimport {value, quotedLine} from '../lexical.js'\r\n\r\nconst staticFileRE = /[^\\s,]+/\r\n\r\nexport default function (liquid, Liquid) {\r\n  const withRE = new RegExp(`with\\\\s+(${value.source})`)\r\n\r\n  liquid.registerTag('include', {\r\n    parse: function (token) {\r\n      let match = staticFileRE.exec(token.args)\r\n      if (match) {\r\n        this.staticValue = match[0]\r\n      }\r\n\r\n      match = value.exec(token.args)\r\n      if (match) {\r\n        this.value = match[0]\r\n      }\r\n\r\n      match = withRE.exec(token.args)\r\n      if (match) {\r\n        this.with = match[1]\r\n      }\r\n    },\r\n    render: async function (scope, hash) {\r\n      let filepath\r\n      if (scope.opts.dynamicPartials) {\r\n        if (quotedLine.exec(this.value)) {\r\n          const template = this.value.slice(1, -1)\r\n          filepath = await liquid.parseAndRender(template, scope.getAll(), scope.opts)\r\n        } else {\r\n          filepath = Liquid.evalValue(this.value, scope)\r\n        }\r\n      } else {\r\n        filepath = this.staticValue\r\n      }\r\n      assert(filepath, `cannot include with empty filename`)\r\n\r\n      const originBlocks = scope.opts.blocks\r\n      const originBlockMode = scope.opts.blockMode\r\n\r\n      scope.opts.blocks = {}\r\n      scope.opts.blockMode = 'output'\r\n      if (this.with) {\r\n        hash[filepath] = Liquid.evalValue(this.with, scope)\r\n      }\r\n      const templates = await liquid.getTemplate(filepath, scope.opts.root)\r\n      scope.push(hash)\r\n      const html = await liquid.renderer.renderTemplates(templates, scope)\r\n      scope.pop(hash)\r\n      scope.opts.blocks = originBlocks\r\n      scope.opts.blockMode = originBlockMode\r\n      return html\r\n    }\r\n  })\r\n}\r\n","import {create} from '../util/underscore.js'\r\nimport assert from '../util/assert.js'\r\nimport {identifier} from '../lexical.js'\r\n\r\nexport default function (liquid, Liquid) {\r\n  const {CaptureScope, AssignScope, DecrementScope} = Liquid.Types\r\n\r\n  liquid.registerTag('decrement', {\r\n    parse: function (token) {\r\n      const match = token.args.match(identifier)\r\n      assert(match, `illegal identifier ${token.args}`)\r\n      this.variable = match[0]\r\n    },\r\n    render: function (scope, hash) {\r\n      let context = scope.findContextFor(\r\n        this.variable,\r\n        ctx => {\r\n          const proto = Object.getPrototypeOf(ctx)\r\n          return proto !== CaptureScope && proto !== AssignScope\r\n        }\r\n      )\r\n      if (!context) {\r\n        context = create(DecrementScope)\r\n        scope.unshift(context)\r\n      }\r\n      if (typeof context[this.variable] !== 'number') {\r\n        context[this.variable] = 0\r\n      }\r\n      return --context[this.variable]\r\n    }\r\n  })\r\n}\r\n","import assert from '../util/assert.js'\r\nimport {value as rValue} from '../lexical.js'\r\n\r\nexport default function (liquid, Liquid) {\r\n  const groupRE = new RegExp(`^(?:(${rValue.source})\\\\s*:\\\\s*)?(.*)$`)\r\n  const candidatesRE = new RegExp(rValue.source, 'g')\r\n\r\n  liquid.registerTag('cycle', {\r\n\r\n    parse: function (tagToken, remainTokens) {\r\n      let match = groupRE.exec(tagToken.args)\r\n      assert(match, `illegal tag: ${tagToken.raw}`)\r\n\r\n      this.group = match[1] || ''\r\n      const candidates = match[2]\r\n\r\n      this.candidates = []\r\n\r\n      while ((match = candidatesRE.exec(candidates))) {\r\n        this.candidates.push(match[0])\r\n      }\r\n      assert(this.candidates.length, `empty candidates: ${tagToken.raw}`)\r\n    },\r\n\r\n    render: function (scope, hash) {\r\n      const group = Liquid.evalValue(this.group, scope)\r\n      const fingerprint = `cycle:${group}:` + this.candidates.join(',')\r\n\r\n      const groups = scope.opts.groups = scope.opts.groups || {}\r\n      let idx = groups[fingerprint]\r\n\r\n      if (idx === undefined) {\r\n        idx = groups[fingerprint] = 0\r\n      }\r\n\r\n      const candidate = this.candidates[idx]\r\n      idx = (idx + 1) % this.candidates.length\r\n      groups[fingerprint] = idx\r\n\r\n      return Liquid.evalValue(candidate, scope)\r\n    }\r\n  })\r\n}\r\n","export default function (liquid, Liquid) {\r\n  liquid.registerTag('if', {\r\n\r\n    parse: function (tagToken, remainTokens) {\r\n      this.branches = []\r\n      this.elseTemplates = []\r\n\r\n      let p\r\n      const stream = liquid.parser.parseStream(remainTokens)\r\n        .on('start', () => this.branches.push({\r\n          cond: tagToken.args,\r\n          templates: (p = [])\r\n        }))\r\n        .on('tag:elsif', token => {\r\n          this.branches.push({\r\n            cond: token.args,\r\n            templates: p = []\r\n          })\r\n        })\r\n        .on('tag:else', () => (p = this.elseTemplates))\r\n        .on('tag:endif', token => stream.stop())\r\n        .on('template', tpl => p.push(tpl))\r\n        .on('end', x => {\r\n          throw new Error(`tag ${tagToken.raw} not closed`)\r\n        })\r\n\r\n      stream.start()\r\n    },\r\n\r\n    render: function (scope, hash) {\r\n      for (const branch of this.branches) {\r\n        const cond = Liquid.evalExp(branch.cond, scope)\r\n        if (Liquid.isTruthy(cond)) {\r\n          return liquid.renderer.renderTemplates(branch.templates, scope)\r\n        }\r\n      }\r\n      return liquid.renderer.renderTemplates(this.elseTemplates, scope)\r\n    }\r\n  })\r\n}\r\n","import assert from '../util/assert.js'\r\nimport {create} from '../util/underscore.js'\r\nimport {identifier} from '../lexical.js'\r\n\r\nexport default function (liquid, Liquid) {\r\n  const {CaptureScope, AssignScope, IncrementScope} = Liquid.Types\r\n\r\n  liquid.registerTag('increment', {\r\n    parse: function (token) {\r\n      const match = token.args.match(identifier)\r\n      assert(match, `illegal identifier ${token.args}`)\r\n      this.variable = match[0]\r\n    },\r\n    render: function (scope, hash) {\r\n      let context = scope.findContextFor(\r\n        this.variable,\r\n        ctx => {\r\n          const proto = Object.getPrototypeOf(ctx)\r\n          return proto !== CaptureScope && proto !== AssignScope\r\n        }\r\n      )\r\n      if (!context) {\r\n        context = create(IncrementScope)\r\n        scope.unshift(context)\r\n      }\r\n      if (typeof context[this.variable] !== 'number') {\r\n        context[this.variable] = 0\r\n      }\r\n      const val = context[this.variable]\r\n      context[this.variable]++\r\n      return val\r\n    }\r\n  })\r\n}\r\n","import assert from '../util/assert.js'\r\nimport {value as rValue} from '../lexical.js'\r\n\r\n/*\r\n * blockMode:\r\n * * \"store\": store rendered html into blocks\r\n * * \"output\": output rendered html\r\n */\r\n\r\nexport default function (liquid, Liquid) {\r\n  const staticFileRE = /\\S+/\r\n\r\n  liquid.registerTag('layout', {\r\n    parse: function (token, remainTokens) {\r\n      let match = staticFileRE.exec(token.args)\r\n      if (match) {\r\n        this.staticLayout = match[0]\r\n      }\r\n\r\n      match = rValue.exec(token.args)\r\n      if (match) {\r\n        this.layout = match[0]\r\n      }\r\n\r\n      this.tpls = liquid.parser.parse(remainTokens)\r\n    },\r\n    render: async function (scope, hash) {\r\n      const layout = scope.opts.dynamicPartials\r\n        ? Liquid.evalValue(this.layout, scope)\r\n        : this.staticLayout\r\n      assert(layout, `cannot apply layout with empty filename`)\r\n\r\n      // render the remaining tokens immediately\r\n      scope.opts.blockMode = 'store'\r\n      const html = await liquid.renderer.renderTemplates(this.tpls, scope)\r\n      if (scope.opts.blocks[''] === undefined) {\r\n        scope.opts.blocks[''] = html\r\n      }\r\n      const templates = await liquid.getTemplate(layout, scope.opts.root)\r\n      scope.push(hash)\r\n      scope.opts.blockMode = 'output'\r\n      const partial = await liquid.renderer.renderTemplates(templates, scope)\r\n      scope.pop(hash)\r\n      return partial\r\n    }\r\n  })\r\n\r\n  liquid.registerTag('block', {\r\n    parse: function (token, remainTokens) {\r\n      const match = /\\w+/.exec(token.args)\r\n      this.block = match ? match[0] : ''\r\n\r\n      this.tpls = []\r\n      const stream = liquid.parser.parseStream(remainTokens)\r\n        .on('tag:endblock', () => stream.stop())\r\n        .on('template', tpl => this.tpls.push(tpl))\r\n        .on('end', () => {\r\n          throw new Error(`tag ${token.raw} not closed`)\r\n        })\r\n      stream.start()\r\n    },\r\n    render: async function (scope) {\r\n      const childDefined = scope.opts.blocks[this.block]\r\n      const html = childDefined !== undefined\r\n        ? childDefined\r\n        : await liquid.renderer.renderTemplates(this.tpls, scope)\r\n\r\n      if (scope.opts.blockMode === 'store') {\r\n        scope.opts.blocks[this.block] = html\r\n        return ''\r\n      }\r\n      return html\r\n    }\r\n  })\r\n}\r\n","export default function (liquid) {\r\n  liquid.registerTag('raw', {\r\n    parse: function (tagToken, remainTokens) {\r\n      this.tokens = []\r\n\r\n      const stream = liquid.parser.parseStream(remainTokens)\r\n      stream\r\n        .on('token', token => {\r\n          if (token.name === 'endraw') stream.stop()\r\n          else this.tokens.push(token)\r\n        })\r\n        .on('end', () => {\r\n          throw new Error(`tag ${tagToken.raw} not closed`)\r\n        })\r\n      stream.start()\r\n    },\r\n    render: function (scope, hash) {\r\n      return this.tokens.map(token => token.raw).join('')\r\n    }\r\n  })\r\n}\r\n","import {mapSeries} from '../util/promise.js'\r\nimport assert from '../util/assert.js'\r\nimport {identifier, value, hash} from '../lexical.js'\r\n\r\nexport default function (liquid, Liquid) {\r\n  const re = new RegExp(`^(${identifier.source})\\\\s+in\\\\s+` +\r\n    `(${value.source})` +\r\n    `(?:\\\\s+${hash.source})*$`)\r\n\r\n  liquid.registerTag('tablerow', {\r\n\r\n    parse: function (tagToken, remainTokens) {\r\n      const match = re.exec(tagToken.args)\r\n      assert(match, `illegal tag: ${tagToken.raw}`)\r\n\r\n      this.variable = match[1]\r\n      this.collection = match[2]\r\n      this.templates = []\r\n\r\n      let p\r\n      const stream = liquid.parser.parseStream(remainTokens)\r\n        .on('start', () => (p = this.templates))\r\n        .on('tag:endtablerow', token => stream.stop())\r\n        .on('template', tpl => p.push(tpl))\r\n        .on('end', () => {\r\n          throw new Error(`tag ${tagToken.raw} not closed`)\r\n        })\r\n\r\n      stream.start()\r\n    },\r\n\r\n    render: async function (scope, hash) {\r\n      let collection = Liquid.evalExp(this.collection, scope) || []\r\n      const offset = hash.offset || 0\r\n      const limit = (hash.limit === undefined) ? collection.length : hash.limit\r\n\r\n      collection = collection.slice(offset, offset + limit)\r\n      const cols = hash.cols || collection.length\r\n      const contexts = collection.map((item, i) => {\r\n        const ctx = {}\r\n        ctx[this.variable] = item\r\n        return ctx\r\n      })\r\n\r\n      let row\r\n      let html = ''\r\n      await mapSeries(contexts, async (context, idx) => {\r\n        row = Math.floor(idx / cols) + 1\r\n        const col = (idx % cols) + 1\r\n        if (col === 1) {\r\n          if (row !== 1) {\r\n            html += '</tr>'\r\n          }\r\n          html += `<tr class=\"row${row}\">`\r\n        }\r\n\r\n        html += `<td class=\"col${col}\">`\r\n        scope.push(context)\r\n        html += await liquid.renderer.renderTemplates(this.templates, scope)\r\n        html += '</td>'\r\n        scope.pop(context)\r\n        return html\r\n      })\r\n      if (row > 0) {\r\n        html += '</tr>'\r\n      }\r\n      return html\r\n    }\r\n  })\r\n}\r\n","export default function (liquid, Liquid) {\r\n  liquid.registerTag('unless', {\r\n    parse: function (tagToken, remainTokens) {\r\n      this.templates = []\r\n      this.elseTemplates = []\r\n      let p\r\n      const stream = liquid.parser.parseStream(remainTokens)\r\n        .on('start', x => {\r\n          p = this.templates\r\n          this.cond = tagToken.args\r\n        })\r\n        .on('tag:else', () => (p = this.elseTemplates))\r\n        .on('tag:endunless', token => stream.stop())\r\n        .on('template', tpl => p.push(tpl))\r\n        .on('end', x => {\r\n          throw new Error(`tag ${tagToken.raw} not closed`)\r\n        })\r\n\r\n      stream.start()\r\n    },\r\n\r\n    render: function (scope, hash) {\r\n      const cond = Liquid.evalExp(this.cond, scope)\r\n      return Liquid.isFalsy(cond)\r\n        ? liquid.renderer.renderTemplates(this.templates, scope)\r\n        : liquid.renderer.renderTemplates(this.elseTemplates, scope)\r\n    }\r\n  })\r\n}\r\n","import For from './for.js'\r\nimport Assign from './assign.js'\r\nimport Capture from './capture.js'\r\nimport Case from './case.js'\r\nimport Comment from './comment.js'\r\nimport Include from './include.js'\r\nimport Decrement from './decrement.js'\r\nimport Cycle from './cycle.js'\r\nimport If from './if.js'\r\nimport Increment from './increment.js'\r\nimport Layout from './layout.js'\r\nimport Raw from './raw.js'\r\nimport Tablerow from './tablerow.js'\r\nimport Unless from './unless.js'\r\n\r\nexport default function (engine, Liquid) {\r\n  Assign(engine, Liquid)\r\n  Capture(engine, Liquid)\r\n  Case(engine, Liquid)\r\n  Comment(engine, Liquid)\r\n  Cycle(engine, Liquid)\r\n  Decrement(engine, Liquid)\r\n  For(engine, Liquid)\r\n  If(engine, Liquid)\r\n  Include(engine, Liquid)\r\n  Increment(engine, Liquid)\r\n  Layout(engine, Liquid)\r\n  Raw(engine, Liquid)\r\n  Tablerow(engine, Liquid)\r\n  Unless(engine, Liquid)\r\n}\r\n","const monthNames = [\r\n  'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August',\r\n  'September', 'October', 'November', 'December'\r\n]\r\nconst dayNames = [\r\n  'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'\r\n]\r\nconst monthNamesShort = monthNames.map(abbr)\r\nconst dayNamesShort = dayNames.map(abbr)\r\nconst suffixes = {\r\n  1: 'st',\r\n  2: 'nd',\r\n  3: 'rd',\r\n  'default': 'th'\r\n}\r\n\r\nfunction abbr (str) {\r\n  return str.slice(0, 3)\r\n}\r\n\r\n// prototype extensions\r\nconst _date = {\r\n  daysInMonth: function (d) {\r\n    const feb = _date.isLeapYear(d) ? 29 : 28\r\n    return [31, feb, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]\r\n  },\r\n\r\n  getDayOfYear: function (d) {\r\n    let num = 0\r\n    for (let i = 0; i < d.getMonth(); ++i) {\r\n      num += _date.daysInMonth(d)[i]\r\n    }\r\n    return num + d.getDate()\r\n  },\r\n\r\n  // Startday is an integer of which day to start the week measuring from\r\n  // TODO: that comment was retarted. fix it.\r\n  getWeekOfYear: function (d, startDay) {\r\n    // Skip to startDay of this week\r\n    const now = this.getDayOfYear(d) + (startDay - d.getDay())\r\n    // Find the first startDay of the year\r\n    const jan1 = new Date(d.getFullYear(), 0, 1)\r\n    const then = (7 - jan1.getDay() + startDay)\r\n    return _number.pad(Math.floor((now - then) / 7) + 1, 2)\r\n  },\r\n\r\n  isLeapYear: function (d) {\r\n    const year = d.getFullYear()\r\n    return !!((year & 3) === 0 && (year % 100 || (year % 400 === 0 && year)))\r\n  },\r\n\r\n  getSuffix: function (d) {\r\n    const str = d.getDate().toString()\r\n    const index = parseInt(str.slice(-1))\r\n    return suffixes[index] || suffixes['default']\r\n  },\r\n\r\n  century: function (d) {\r\n    return parseInt(d.getFullYear().toString().substring(0, 2), 10)\r\n  }\r\n}\r\n\r\nconst _number = {\r\n  pad: function (value, size, ch) {\r\n    if (!ch) ch = '0'\r\n    let result = value.toString()\r\n    let pad = size - result.length\r\n\r\n    while (pad-- > 0) {\r\n      result = ch + result\r\n    }\r\n\r\n    return result\r\n  }\r\n}\r\n\r\nconst formatCodes = {\r\n  a: function (d) {\r\n    return dayNamesShort[d.getDay()]\r\n  },\r\n  A: function (d) {\r\n    return dayNames[d.getDay()]\r\n  },\r\n  b: function (d) {\r\n    return monthNamesShort[d.getMonth()]\r\n  },\r\n  B: function (d) {\r\n    return monthNames[d.getMonth()]\r\n  },\r\n  c: function (d) {\r\n    return d.toLocaleString()\r\n  },\r\n  C: function (d) {\r\n    return _date.century(d)\r\n  },\r\n  d: function (d) {\r\n    return _number.pad(d.getDate(), 2)\r\n  },\r\n  e: function (d) {\r\n    return _number.pad(d.getDate(), 2, ' ')\r\n  },\r\n  H: function (d) {\r\n    return _number.pad(d.getHours(), 2)\r\n  },\r\n  I: function (d) {\r\n    return _number.pad(d.getHours() % 12 || 12, 2)\r\n  },\r\n  j: function (d) {\r\n    return _number.pad(_date.getDayOfYear(d), 3)\r\n  },\r\n  k: function (d) {\r\n    return _number.pad(d.getHours(), 2, ' ')\r\n  },\r\n  l: function (d) {\r\n    return _number.pad(d.getHours() % 12 || 12, 2, ' ')\r\n  },\r\n  L: function (d) {\r\n    return _number.pad(d.getMilliseconds(), 3)\r\n  },\r\n  m: function (d) {\r\n    return _number.pad(d.getMonth() + 1, 2)\r\n  },\r\n  M: function (d) {\r\n    return _number.pad(d.getMinutes(), 2)\r\n  },\r\n  p: function (d) {\r\n    return (d.getHours() < 12 ? 'AM' : 'PM')\r\n  },\r\n  P: function (d) {\r\n    return (d.getHours() < 12 ? 'am' : 'pm')\r\n  },\r\n  q: function (d) {\r\n    return _date.getSuffix(d)\r\n  },\r\n  s: function (d) {\r\n    return Math.round(d.valueOf() / 1000)\r\n  },\r\n  S: function (d) {\r\n    return _number.pad(d.getSeconds(), 2)\r\n  },\r\n  u: function (d) {\r\n    return d.getDay() || 7\r\n  },\r\n  U: function (d) {\r\n    return _date.getWeekOfYear(d, 0)\r\n  },\r\n  w: function (d) {\r\n    return d.getDay()\r\n  },\r\n  W: function (d) {\r\n    return _date.getWeekOfYear(d, 1)\r\n  },\r\n  x: function (d) {\r\n    return d.toLocaleDateString()\r\n  },\r\n  X: function (d) {\r\n    return d.toLocaleTimeString()\r\n  },\r\n  y: function (d) {\r\n    return d.getFullYear().toString().substring(2, 4)\r\n  },\r\n  Y: function (d) {\r\n    return d.getFullYear()\r\n  },\r\n  z: function (d) {\r\n    const tz = d.getTimezoneOffset() / 60 * 100\r\n    return (tz > 0 ? '-' : '+') + _number.pad(Math.abs(tz), 4)\r\n  },\r\n  '%': function () {\r\n    return '%'\r\n  }\r\n}\r\nformatCodes.h = formatCodes.b\r\nformatCodes.N = formatCodes.L\r\n\r\nexport default function (d, format) {\r\n  let output = ''\r\n  let remaining = format\r\n\r\n  while (true) {\r\n    const r = /%./g\r\n    const results = r.exec(remaining)\r\n\r\n    // No more format codes. Add the remaining text and return\r\n    if (!results) {\r\n      return output + remaining\r\n    }\r\n\r\n    // Add the preceding text\r\n    output += remaining.slice(0, r.lastIndex - 2)\r\n    remaining = remaining.slice(r.lastIndex)\r\n\r\n    // Add the format code\r\n    const ch = results[0].charAt(1)\r\n    const func = formatCodes[ch]\r\n    output += func ? func.call(this, d) : '%' + ch\r\n  }\r\n}\r\n","import strftime from './util/strftime.js'\nimport * as _ from './util/underscore.js'\nimport {isTruthy} from './syntax.js'\n\nconst escapeMap = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&#34;',\n  \"'\": '&#39;'\n}\nconst unescapeMap = {\n  '&amp;': '&',\n  '&lt;': '<',\n  '&gt;': '>',\n  '&#34;': '\"',\n  '&#39;': \"'\"\n}\n\nconst filters = {\n  'abs': v => Math.abs(v),\n  'append': (v, arg) => v + arg,\n  'capitalize': str => stringify(str).charAt(0).toUpperCase() + str.slice(1),\n  'ceil': v => Math.ceil(v),\n  'concat': (v, arg) => Array.prototype.concat.call(v, arg),\n  'date': (v, arg) => {\n    let date = v\n    if (v === 'now') {\n      date = new Date()\n    } else if (_.isString(v)) {\n      date = new Date(v)\n    }\n    return isValidDate(date) ? strftime(date, arg) : v\n  },\n  'default': (v, arg) => isTruthy(v) ? v : arg,\n  'divided_by': (v, arg) => v / arg,\n  'downcase': v => v.toLowerCase(),\n  'escape': escape,\n\n  'escape_once': str => escape(unescape(str)),\n  'first': v => v[0],\n  'floor': v => Math.floor(v),\n  'join': (v, arg) => v.join(arg),\n  'last': v => _.last(v),\n  'lstrip': v => stringify(v).replace(/^\\s+/, ''),\n  'map': (arr, arg) => arr.map(v => v[arg]),\n  'minus': bindFixed((v, arg) => v - arg),\n  'modulo': bindFixed((v, arg) => v % arg),\n  'newline_to_br': v => v.replace(/\\n/g, '<br />'),\n  'plus': bindFixed((v, arg) => Number(v) + Number(arg)),\n  'prepend': (v, arg) => arg + v,\n  'remove': (v, arg) => v.split(arg).join(''),\n  'remove_first': (v, l) => v.replace(l, ''),\n  'replace': (v, pattern, replacement) =>\n    stringify(v).split(pattern).join(replacement),\n  'replace_first': (v, arg1, arg2) => stringify(v).replace(arg1, arg2),\n  'reverse': v => v.reverse(),\n  'round': (v, arg) => {\n    const amp = Math.pow(10, arg || 0)\n    return Math.round(v * amp, arg) / amp\n  },\n  'rstrip': str => stringify(str).replace(/\\s+$/, ''),\n  'size': v => v.length,\n  'slice': (v, begin, length) =>\n    v.substr(begin, length === undefined ? 1 : length),\n  'sort': (v, arg) => v.sort(arg),\n  'split': (v, arg) => stringify(v).split(arg),\n  'strip': (v) => stringify(v).trim(),\n  'strip_html': v => stringify(v).replace(/<script.*?<\\/script>|<!--.*?-->|<style.*?<\\/style>|<.*?>/g, ''),\n  'strip_newlines': v => stringify(v).replace(/\\n/g, ''),\n  'times': (v, arg) => v * arg,\n  'truncate': (v, l, o) => {\n    v = stringify(v)\n    o = (o === undefined) ? '...' : o\n    l = l || 16\n    if (v.length <= l) return v\n    return v.substr(0, l - o.length) + o\n  },\n  'truncatewords': (v, l, o) => {\n    if (o === undefined) o = '...'\n    const arr = v.split(' ')\n    let ret = arr.slice(0, l).join(' ')\n    if (arr.length > l) ret += o\n    return ret\n  },\n  'uniq': function (arr) {\n    const u = {}\n    return (arr || []).filter(val => {\n      if (u.hasOwnProperty(val)) {\n        return false\n      }\n      u[val] = true\n      return true\n    })\n  },\n  'upcase': str => stringify(str).toUpperCase(),\n  'url_decode': x => x.split('+').map(decodeURIComponent).join(' '),\n  'url_encode': x => x.split(' ').map(encodeURIComponent).join('+')\n}\n\nfunction escape (str) {\n  return stringify(str).replace(/&|<|>|\"|'/g, m => escapeMap[m])\n}\n\nfunction unescape (str) {\n  return stringify(str).replace(/&(amp|lt|gt|#34|#39);/g, m => unescapeMap[m])\n}\n\nfunction getFixed (v) {\n  const p = (v + '').split('.')\n  return (p.length > 1) ? p[1].length : 0\n}\n\nfunction getMaxFixed (l, r) {\n  return Math.max(getFixed(l), getFixed(r))\n}\n\nfunction stringify (obj) {\n  return obj + ''\n}\n\nfunction bindFixed (cb) {\n  return (l, r) => {\n    const f = getMaxFixed(l, r)\n    return cb(l, r).toFixed(f)\n  }\n}\n\nfunction isValidDate (date) {\n  return date instanceof Date && !isNaN(date.getTime())\n}\n\nexport default function registerAll (liquid) {\n  return _.forOwn(filters, (func, name) => liquid.registerFilter(name, func))\n}\n\nregisterAll.filters = filters\n","import 'regenerator-runtime/runtime'\r\nimport * as Scope from './scope'\r\nimport * as template from './template'\r\nimport * as _ from './util/underscore.js'\r\nimport assert from './util/assert.js'\r\nimport * as tokenizer from './tokenizer.js'\r\nimport Render from './render.js'\r\nimport Tag from './tag.js'\r\nimport Filter from './filter.js'\r\nimport Parser from './parser'\r\nimport {isTruthy, isFalsy, evalExp, evalValue} from './syntax.js'\r\nimport {ParseError, TokenizationError, RenderBreakError, AssertionError} from './util/error.js'\r\nimport tags from './tags/index.js'\r\nimport filters from './filters.js'\r\n\r\nconst _engine = {\r\n  init: function (tag, filter, options) {\r\n    if (options.cache) {\r\n      this.cache = {}\r\n    }\r\n    this.options = options\r\n    this.tag = tag\r\n    this.filter = filter\r\n    this.parser = Parser(tag, filter)\r\n    this.renderer = Render()\r\n\r\n    tags(this, Liquid)\r\n    filters(this, Liquid)\r\n\r\n    return this\r\n  },\r\n  parse: function (html, filepath) {\r\n    const tokens = tokenizer.parse(html, filepath, this.options)\r\n    return this.parser.parse(tokens)\r\n  },\r\n  render: function (tpl, ctx, opts) {\r\n    opts = _.assign({}, this.options, opts)\r\n    const scope = Scope.factory(ctx, opts)\r\n    return this.renderer.renderTemplates(tpl, scope)\r\n  },\r\n  parseAndRender: async function (html, ctx, opts) {\r\n    const tpl = await this.parse(html)\r\n    return this.render(tpl, ctx, opts)\r\n  },\r\n  getTemplate: async function (file, root) {\r\n    const filepath = await template.resolve(file, root, this.options)\r\n    return this.respectCache(filepath, async () => {\r\n      const str = await template.read(filepath)\r\n      return this.parse(str, filepath)\r\n    })\r\n  },\r\n  renderFile: async function (file, ctx, opts) {\r\n    opts = _.assign({}, opts)\r\n    const templates = await this.getTemplate(file, opts.root)\r\n    return this.render(templates, ctx, opts)\r\n  },\r\n  respectCache: async function (key, getter) {\r\n    const cacheEnabled = this.options.cache\r\n    if (cacheEnabled && this.cache[key]) {\r\n      return this.cache[key]\r\n    }\r\n    const value = await getter()\r\n    if (cacheEnabled) {\r\n      this.cache[key] = value\r\n    }\r\n    return value\r\n  },\r\n  evalValue: function (str, scope) {\r\n    const tpl = this.parser.parseValue(str.trim())\r\n    return this.renderer.evalValue(tpl, scope)\r\n  },\r\n  registerFilter: function (name, filter) {\r\n    return this.filter.register(name, filter)\r\n  },\r\n  registerTag: function (name, tag) {\r\n    return this.tag.register(name, tag)\r\n  },\r\n  express: function (opts) {\r\n    opts = opts || {}\r\n    const self = this\r\n    return function (filePath, ctx, cb) {\r\n      assert(_.isArray(this.root) || _.isString(this.root),\r\n        'illegal views root, are you using express.js?')\r\n      opts.root = this.root\r\n      self.renderFile(filePath, ctx, opts).then(html => cb(null, html), cb)\r\n    }\r\n  }\r\n}\r\n\r\nfunction normalizeStringArray (value) {\r\n  if (_.isArray(value)) return value\r\n  if (_.isString(value)) return [value]\r\n  throw new TypeError('illegal root: ' + value)\r\n}\r\n\r\nexport default function Liquid (options) {\r\n  options = _.assign({\r\n    root: ['.'],\r\n    cache: false,\r\n    extname: '',\r\n    dynamicPartials: true,\r\n    trim_tag_right: false,\r\n    trim_tag_left: false,\r\n    trim_value_right: false,\r\n    trim_value_left: false,\r\n    greedy: true,\r\n    strict_filters: false,\r\n    strict_variables: false\r\n  }, options)\r\n  options.root = normalizeStringArray(options.root)\r\n\r\n  const engine = _.create(_engine)\r\n  engine.init(Tag(), Filter(options), options)\r\n  return engine\r\n}\r\n\r\nLiquid.isTruthy = isTruthy\r\nLiquid.isFalsy = isFalsy\r\nLiquid.evalExp = evalExp\r\nLiquid.evalValue = evalValue\r\nLiquid.Types = {\r\n  ParseError,\r\n  TokenizationError,\r\n  RenderBreakError,\r\n  AssertionError,\r\n  AssignScope: {},\r\n  CaptureScope: {},\r\n  IncrementScope: {},\r\n  DecrementScope: {}\r\n}\r\n"],"names":["global","Op","Object","prototype","hasOwn","hasOwnProperty","undefined","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","inModule","module","runtime","regeneratorRuntime","exports","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","makeInvokeMethod","tryCatch","fn","obj","arg","type","call","err","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","constructor","displayName","defineIteratorMethods","forEach","method","isGeneratorFunction","genFun","ctor","name","mark","setPrototypeOf","__proto__","awrap","__await","AsyncIterator","invoke","resolve","reject","record","result","value","Promise","then","unwrapped","error","previousPromise","enqueue","callInvokeWithMethodAndArg","async","iter","next","done","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","info","resultName","nextLoc","toString","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","keys","object","key","reverse","length","pop","iterable","iteratorMethod","isNaN","i","skipTempReset","prev","charAt","slice","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","Function","toStr","isString","stringify","isNil","String","to_liquid","toLiquid","RegExp","Date","cache","JSON","isObject","indexOf","proto","isArray","forOwn","iteratee","k","assign","srcs","Array","arguments","src","last","arr","range","start","step","singleQuoted","doubleQuoted","quoted","source","quoteBalanced","integer","number","bool","identifier","subscript","literal","variable","rangeLimit","rangeCapture","hash","hashCapture","tagLine","literalLine","variableLine","numberLine","boolLine","quotedLine","rangeLine","integerLine","valueDeclaration","valueList","filter","filterCapture","filterLine","operators","isInteger","str","test","isLiteral","isVariable","matchValue","exec","parseLiteral","res","match","Number","toLowerCase","initError","captureStackTrace","initLiquidError","token","input","line","file","mkContext","message","mkMessage","stack","TokenizationError","_","ParseError","e","originalError","RenderError","tpl","RenderBreakError","AssertionError","lines","split","begin","Math","max","end","min","map","l","align","join","n","blank","msg","predicate","Scope","getAll","contexts","reduce","ctx","val","get","path","paths","propertyAccessSeq","scope","findContextFor","readProperty","set","v","some","unshift","findIndex","splice","candidate","opts","strict_variables","seq","j","delemiter","assert","matchRightBracket","lexical","factory","defaultOptions","dynamicPartials","strict_filters","blocks","root","domResolve","base","document","createElement","href","head","getElementsByTagName","insertBefore","firstChild","a","resolved","removeChild","filepath","options","url","replace","origin","extname","xhr","XMLHttpRequest","onload","status","responseText","statusText","onerror","open","send","read","whiteSpaceCtrl","tokens","greedy","inRaw","shouldTrimLeft","trimLeft","shouldTrimRight","trimRight","trim_left","trim_tag_left","trim_value_left","trim_right","trim_tag_right","trim_value_right","rLeft","rRight","parse","rLiquid","currIndent","lineNumber","LineNumber","lastMatchEnd","lastIndex","index","parseHTMLToken","parseTagToken","trim","parseValueToken","raw","pos","indent","args","htmlFragment","html","parsedLinesCount","lastMatchBegin","isTruthy","r","Operators","evalExp","exp","operatorREs","operatorRE","expRE","op","low","evalValue","high","isFalsy","render","renderTemplates","templates","template","renderTag","partial","renderValue","renderTemplate","resolvedHTML","filters","initial","instance","markup","tagImpls","_tagInstance","impl","tagImpl","register","tag","construct","clear","valueRE","_filterInstance","output","apply","argList","x","re","keyMatch","currentMatchIsKey","Tag","Filter","stream","init","handlers","on","cb","trigger","event","h","stopRequested","shift","parseToken","parseTag","parseValue","substr","parseStream","s","mapSeries","ret","item","idx","liquid","Liquid","collection","renderer","elseTemplates","offset","limit","reversed","forloop","first","index0","rindex","rindex0","finished","Types","registerTag","tagToken","remainTokens","p","parser","AssignScope","CaptureScope","cond","cases","branch","staticFileRE","withRE","staticValue","with","parseAndRender","originBlocks","originBlockMode","blockMode","getTemplate","DecrementScope","groupRE","rValue","candidatesRE","group","candidates","fingerprint","groups","branches","IncrementScope","staticLayout","layout","tpls","block","childDefined","cols","row","floor","col","engine","Assign","Capture","Case","Comment","Cycle","Decrement","For","If","Include","Increment","Layout","Raw","Tablerow","Unless","monthNames","dayNames","monthNamesShort","abbr","dayNamesShort","suffixes","_date","daysInMonth","d","feb","isLeapYear","getDayOfYear","num","getMonth","getDate","getWeekOfYear","startDay","now","getDay","jan1","getFullYear","_number","pad","year","getSuffix","parseInt","century","substring","size","ch","formatCodes","A","b","B","c","toLocaleString","C","H","getHours","I","L","getMilliseconds","m","M","getMinutes","P","q","round","valueOf","S","getSeconds","u","U","w","W","toLocaleDateString","X","toLocaleTimeString","y","Y","z","tz","getTimezoneOffset","abs","N","format","remaining","results","func","escapeMap","unescapeMap","toUpperCase","ceil","concat","date","isValidDate","strftime","escape","unescape","bindFixed","pattern","replacement","arg1","arg2","amp","pow","sort","o","decodeURIComponent","encodeURIComponent","getFixed","getMaxFixed","f","toFixed","getTime","registerAll","registerFilter","_engine","Parser","Render","tags","tokenizer","respectCache","renderFile","getter","cacheEnabled","express","filePath","normalizeStringArray"],"mappings":"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"}